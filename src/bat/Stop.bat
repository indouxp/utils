:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
::
:: Stop.bat
::

@echo off

set START_TIME=%TIME%
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
: StopInstance.bat実行
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
call %~dp0StopInstance.bat %COMPUTERNAME% orcl40
set RC=%errorlevel%
:if %RC% neq 0 goto :err_020

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
: StopCRS.bat実行
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
call %~dp0StopCRS.bat
set RC=%errorlevel%
if %RC% neq 0 goto :err_010

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
: StopCRS.bat実行
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
call %~dp0StopSC.bat
set RC=%errorlevel%
if %RC% neq 0 goto :err_030


:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
: sc query
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
sc query | findstr /i "Oracle" | findstr /i "SERVICE_NAME" | sort

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:done
  echo %START_TIME% - %TIME%
  echo インスタンス・クラスタ停止成功
  exit /b 0

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:err_010
  echo %START_TIME% - %TIME%
  echo StopCRS.bat失敗
  exit /b %RC%

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:err_020
  echo %START_TIME% - %TIME%
  echo StopInstance.bat失敗
  exit /b %RC%

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:err_030
  echo %START_TIME% - %TIME%
  echo StopSC.bat失敗
  exit /b %RC%